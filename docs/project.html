<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <title id="page-title">Загрузка...</title>
  <meta id="page-description" name="description" content=""/>
  <meta id="og-image" property="og:image" content=""/>
  <meta id="twitter-image" property="twitter:image" content=""/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <link href="/Portfolio/assets/62797855494abeff5a9f1db0/css/bugrov.webflow.31de432ed.css" rel="stylesheet" type="text/css"/>
  <link href="/Portfolio/assets/62797855494abeff5a9f1db0/6468980f8e8cabed8936eb7a_favicon.ico" rel="shortcut icon" type="image/x-icon"/>
  <link href="/Portfolio/assets/62797855494abeff5a9f1db0/6468993c6861d8bfa09d56ed_webclip.jpg" rel="apple-touch-icon"/>
  <style>
    * {
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    .loading-state {
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 50vh;
      color: #888;
    }
    .error-state {
      text-align: center;
      padding: 80px 20px;
      color: #ff4444;
    }
  </style>
</head>
<body class="body-new">
  <!-- Navigation -->
  <div data-animation="default" data-collapse="medium" data-duration="400" data-easing="ease" data-easing2="ease" role="banner" class="navbar-new w-nav">
    <div class="container-new nav-container">
      <a href="/Portfolio/" class="brand w-nav-brand">
        <div class="logo-text">Bugrov.space</div>
      </a>
      <nav role="navigation" class="nav-menu w-nav-menu">
        <div class="nav-links-wrap">
          <div class="nav-links-box">
            <a href="/Portfolio/cases" class="nav-link-new w-nav-link">Кейсы</a>
            <a href="/Portfolio/about" class="nav-link-new w-nav-link">Обо мне</a>
            <a href="/Portfolio/audit" class="nav-link-new w-nav-link">Аудит</a>
            <a href="/Portfolio/rekomendacii" class="nav-link-new w-nav-link">Рекомендации</a>
          </div>
          <div class="nav-links-box">
            <a href="/Portfolio/contacts" class="nav-link-new w-nav-link">Контакты</a>
          </div>
        </div>
      </nav>
      <div class="menu-button w-nav-button">
        <div class="burger-wrap">
          <div class="burger-line1"></div>
          <div class="burger-line2"></div>
          <div class="burger-line3"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Page Content -->
  <div class="page-wrap fixed-nav-page-wrap">
    <!-- Loading State -->
    <div id="loading" class="loading-state">
      <div>Загрузка проекта...</div>
    </div>

    <!-- Error State -->
    <div id="error" class="error-state" style="display: none;">
      <h2>Проект не найден</h2>
      <p>Возможно, проект был удалён или ссылка неверна.</p>
      <a href="/Portfolio/cases" class="round-button w-inline-block" style="margin-top: 20px;">
        <div>← Вернуться к кейсам</div>
      </a>
    </div>

    <!-- Project Content -->
    <div id="content" style="display: none;">
      <!-- Hero Section -->
      <section class="section-new hero-section">
        <div class="container-new">
          <div class="projects-hh-wrap">
            <h1 id="project-title" class="h1-new project-h1"></h1>
            <div class="project-hero-buttons">
              <a href="javascript:history.back(-1)" class="round-button w-inline-block">
                <div class="_24-button-arrow">
                  <div class="svg w-embed">
                    <svg width="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M9 14L4 9L9 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      <path d="M20 20V13C20 11.9391 19.5786 10.9217 18.8284 10.1716C18.0783 9.42143 17.0609 9 16 9H4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </div>
                </div>
              </a>
              <a id="website-link" href="#" class="round-button site-button w-inline-block" style="display: none;">
                <div>на сайт</div>
                <div class="_24-button-arrow">
                  <div class="svg w-embed">
                    <svg width="100%" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M5 12.5H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      <path d="M12 5.5L19 12.5L12 19.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </div>
                </div>
              </a>
            </div>
          </div>

          <!-- Project Info -->
          <div class="content-block mt-100">
            <div class="_4-col-grid" id="project-info">
              <!-- Will be populated by JavaScript -->
            </div>
          </div>

          <!-- Short Description -->
          <div class="content-block mt-100 is-relative" id="short-description-block" style="display: none;">
            <div class="pi-title absolute-on-dt">О проекте</div>
            <div id="short-description" class="text-45px"></div>
          </div>

          <!-- Cover Image -->
          <div class="content-block mt-100" id="cover-image-block" style="display: none;">
            <div class="image-wrap">
              <div class="image-wrapper">
                <img id="cover-image" src="" loading="lazy" alt="" class="image-contain"/>
                <div class="image-owerlay"></div>
              </div>
            </div>
          </div>

          <!-- Full Description -->
          <div class="content-block mt-100" id="description-block" style="display: none;">
            <div class="_4-col-grid">
              <div class="pi-title">Описание</div>
              <div id="description" class="rtb w-richtext" style="grid-column: span 3;"></div>
            </div>
          </div>
        </div>
      </section>

      <!-- Gallery Section -->
      <section class="section-new project-s2-section" id="gallery-section" style="display: none;">
        <div class="container-new">
          <div class="collection-list-wrapper">
            <div id="gallery" role="list" class="w-dyn-items">
              <!-- Gallery items will be populated by JavaScript -->
            </div>
          </div>
        </div>
      </section>

      <!-- Footer -->
      <section id="footer" class="section-new footer-section">
        <div class="footer-scroll-text-row">
          <div class="footer-scroll-text-wrap">
            <div class="footer-scroll-text-box">
              <div class="footer-scroll-text">bugrov studio bugrov studio </div>
            </div>
            <div class="footer-scroll-text-box">
              <div class="footer-scroll-text">bugrov studio bugrov studio</div>
            </div>
          </div>
        </div>
        <div class="container-new">
          <div class="section-core">
            <div class="_4-col-grid footer-grid">
              <div class="footer-col">
                <div class="footer-link-row"><a href="https://www.behance.net/denisbugrov" target="_blank" class="footer-sl">Behance</a></div>
                <div class="footer-link-row"><a href="https://dprofile.ru/millman" target="_blank" class="footer-sl">Dprofile</a></div>
                <div class="footer-link-row"><a href="https://vk.com/bugrovdesign" target="_blank" class="footer-sl">VK</a></div>
              </div>
              <div class="footer-col">
                <div class="footer-link-row"><a href="/Portfolio/cases" class="footer-link">Кейсы</a></div>
                <div class="footer-link-row"><a href="/Portfolio/about" class="footer-link">Обо мне</a></div>
                <div class="footer-link-row"><a href="/Portfolio/audit" class="footer-link">Аудит</a></div>
                <div class="footer-link-row"><a href="/Portfolio/rekomendacii" class="footer-link">Рекомендации</a></div>
                <div class="footer-link-row"><a href="/Portfolio/contacts" class="footer-link">Контакты</a></div>
              </div>
            </div>
          </div>
          <div class="footer-bottom">
            <div>Bugrov.space 2025</div>
            <div class="text-center">ИП Бугров <br/>ИНН 781428200302 <br/>ОГРНИП 318784700283660</div>
            <div>all rights reveserved</div>
          </div>
        </div>
      </section>
    </div>
  </div>

  <script src="/Portfolio/assets/js/jquery-3.5.1.min.dc5e7f18c8.js" type="text/javascript"></script>
  <script src="/Portfolio/assets/62797855494abeff5a9f1db0/js/webflow.d48fc120a.js" type="text/javascript"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked@11.1.0/marked.min.js"></script>
  <script src="/Portfolio/api-config.js"></script>
  <script>
    const API_BASE = window.__API_BASE || 'https://portfolio-saqh.onrender.com';
    const ASSETS_BASE = 'https://aksenod.github.io';

    // Get slug from URL parameter
    const urlParams = new URLSearchParams(window.location.search);
    const slug = urlParams.get('slug');

    if (!slug) {
      showError();
    } else {
      loadProject(slug);
    }

    async function loadProject(slug) {
      try {
        const response = await fetch(`${API_BASE}/projects/${slug}`);

        if (!response.ok) {
          throw new Error('Project not found');
        }

        const project = await response.json();
        renderProject(project);
      } catch (error) {
        console.error('Error loading project:', error);
        showError();
      }
    }

    function normalizeImageUrl(url) {
      if (!url) return '';
      url = String(url).trim();
      if (url.startsWith('http://') || url.startsWith('https://')) return url;
      if (url.startsWith('data:')) return url;
      if (url.startsWith('/Portfolio/')) return ASSETS_BASE + url;
      if (url.startsWith('Portfolio/')) return ASSETS_BASE + '/' + url;
      if (url.startsWith('/assets/')) return ASSETS_BASE + '/Portfolio' + url;
      if (url.startsWith('/')) return ASSETS_BASE + '/Portfolio' + url;
      return ASSETS_BASE + '/' + url;
    }

    function renderProject(project) {
      // Update page title and meta
      document.getElementById('page-title').textContent = `${project.category}, ${project.title}`;
      document.getElementById('page-description').setAttribute('content', project.short_description || '');

      const coverUrl = normalizeImageUrl(project.cover_image);
      if (coverUrl) {
        document.getElementById('og-image').setAttribute('content', coverUrl);
        document.getElementById('twitter-image').setAttribute('content', coverUrl);
      }

      // Render title
      document.getElementById('project-title').textContent = project.title;

      // Render website link
      if (project.website_url) {
        const websiteLink = document.getElementById('website-link');
        websiteLink.href = project.website_url;
        websiteLink.style.display = 'flex';
      }

      // Render project info
      const infoHtml = `
        ${project.specialization ? `<div class="project-info-col"><div class="pi-title">специализация</div><div>${project.specialization}</div></div>` : ''}
        ${project.duration ? `<div class="project-info-col"><div class="pi-title">срок</div><div>${project.duration}</div></div>` : ''}
        ${project.services && project.services.length ? `
          <div class="project-info-col">
            <div class="pi-title">услуги</div>
            <div>${project.services.map(s => `<div>${s}</div>`).join('')}</div>
          </div>
        ` : ''}
        ${project.year ? `<div class="project-info-col"><div class="pi-title">год</div><div>${project.year}</div></div>` : ''}
      `;
      document.getElementById('project-info').innerHTML = infoHtml;

      // Render short description
      if (project.short_description) {
        document.getElementById('short-description').textContent = project.short_description;
        document.getElementById('short-description-block').style.display = 'block';
      }

      // Render cover image
      if (coverUrl) {
        document.getElementById('cover-image').src = coverUrl;
        document.getElementById('cover-image-block').style.display = 'block';
      }

      // Render full description (Markdown)
      if (project.description) {
        const html = marked.parse(project.description);
        document.getElementById('description').innerHTML = html;
        document.getElementById('description-block').style.display = 'block';
      }

      // Render gallery
      if (project.gallery && project.gallery.length) {
        const galleryHtml = project.gallery.map(url => {
          const imgUrl = normalizeImageUrl(url);
          return `
            <div role="listitem" class="collection-item w-dyn-item">
              <img src="${imgUrl}" loading="lazy" alt="" class="image"/>
            </div>
          `;
        }).join('');
        document.getElementById('gallery').innerHTML = galleryHtml;
        document.getElementById('gallery-section').style.display = 'block';
      }

      // Show content, hide loading
      document.getElementById('loading').style.display = 'none';
      document.getElementById('content').style.display = 'block';
    }

    function showError() {
      document.getElementById('loading').style.display = 'none';
      document.getElementById('error').style.display = 'block';
    }
  </script>
</body>
</html>
