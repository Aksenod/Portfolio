<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <title>Загрузка проекта...</title>
  <meta name="description" content=""/>
  <meta property="og:title" content=""/>
  <meta property="og:description" content=""/>
  <meta property="og:image" content=""/>
  <meta property="twitter:title" content=""/>
  <meta property="twitter:description" content=""/>
  <meta property="twitter:image" content=""/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <meta content="Webflow" name="generator"/>
  <link href="/Portfolio/assets/62797855494abeff5a9f1db0/css/bugrov.webflow.31de432ed.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="/Portfolio/assets/62797855494abeff5a9f1db0/6468980f8e8cabed8936eb7a_favicon.ico" rel="shortcut icon" type="image/x-icon"/>
  <link href="/Portfolio/assets/62797855494abeff5a9f1db0/6468993c6861d8bfa09d56ed_webclip.jpg" rel="apple-touch-icon"/>
  <meta name="robots" content="noindex, nofollow">
  <style>
    * {
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
  </style>
  <meta name="facebook-domain-verification" content="mlk59ybu44651lzcbhhxjfl8vfae8q" />
  <script async src="https://cdn.jsdelivr.net/npm/@finsweet/attributes-cmsslider@1/cmsslider.js"></script>
</head>
<body class="body-new">
  <div id="app"></div>

  <script src="/Portfolio/api-config.js"></script>
  <script>
    const API_BASE = window.__API_BASE || 'https://portfolio-saqh.onrender.com';

    function getSlug() {
      const pathParts = window.location.pathname.split('/').filter(Boolean);
      const last = pathParts[pathParts.length - 1];
      if (last && last !== 'index.html') return last;

      try {
        const params = new URLSearchParams(window.location.search || '');
        const originalPath = params.get('path');
        if (originalPath) {
          const originalParts = originalPath.split('/').filter(Boolean);
          const originalLast = originalParts[originalParts.length - 1];
          if (originalLast && originalLast !== 'index.html') return originalLast;
        }
      } catch (e) {}

      return '';
    }

    const slug = getSlug();

    async function loadProject() {
      try {
        const response = await fetch(`${API_BASE}/projects/${slug}`);
        if (!response.ok) {
          showError('Проект не найден', 'Возможно, он был удален или еще не опубликован.');
          return;
        }

        const project = await response.json();
        renderProject(project);
      } catch (error) {
        console.error('Failed to load project:', error);
        showError('Ошибка соединения', 'Проверьте подключение к интернету и попробуйте снова.');
      }
    }

    function showError(title, message) {
      document.getElementById('app').innerHTML = `
        <div style="display:flex;align-items:center;justify-content:center;min-height:100vh;text-align:center;padding:60px 20px;color:#666;">
          <div>
            <h1 style="font-size:24px;margin-bottom:16px;">${title}</h1>
            <p>${message}</p>
            <p><a href="/Portfolio/cases" style="color:#007bff;">← Вернуться к кейсам</a></p>
          </div>
        </div>
      `;
    }

    function renderProject(project) {
      document.title = `${project.category || ''}, ${project.title} — Bugrov.space`;
      
      let metaDesc = document.querySelector('meta[name="description"]');
      if (metaDesc) metaDesc.content = project.short_description || '';

      let metaOgTitle = document.querySelector('meta[property="og:title"]');
      if (metaOgTitle) metaOgTitle.content = project.title;

      let metaOgDesc = document.querySelector('meta[property="og:description"]');
      if (metaOgDesc) metaOgDesc.content = project.short_description || '';

      if (project.cover_image) {
        let metaOgImage = document.querySelector('meta[property="og:image"]');
        if (metaOgImage) metaOgImage.content = project.cover_image;
        
        let metaTwitterImage = document.querySelector('meta[property="twitter:image"]');
        if (metaTwitterImage) metaTwitterImage.content = project.cover_image;
      }

      document.getElementById('app').innerHTML = renderFullPage(project);
    }

    function renderFullPage(project) {
      const projectInfoHtml = `
        <div class="_4-col-grid">
          <div class="project-info-col">
            <div class="pi-title">специализация</div>
            <div>${escapeHtml(project.specialization || '')}</div>
          </div>
          <div class="project-info-col">
            <div class="pi-title">срок</div>
            <div>${escapeHtml(project.duration || '')}</div>
          </div>
          <div class="project-info-col">
            <div class="pi-title">услуги</div>
            <div class="w-dyn-list">
              <div role="list" class="w-dyn-items">
                ${(project.services || []).map(service => `
                  <div role="listitem" class="w-dyn-item">
                    <div>${escapeHtml(service)}</div>
                  </div>
                `).join('')}
              </div>
            </div>
          </div>
          <div class="project-info-col">
            <div class="pi-title">год</div>
            <div>${escapeHtml(project.year || '')}</div>
          </div>
        </div>
      `;

      let galleryHtml = '';
      if (project.gallery && project.gallery.length > 0) {
        galleryHtml = `
          <section class="section-new project-s2-section">
            <div class="container-new">
              <div class="section-core is-relative">
                <div class="heading-wrap is-uplined"></div>
              </div>
              <div class="content-block">
                <div class="w-dyn-list">
                  <div role="list" class="w-dyn-items">
                    ${project.gallery.map(img => `
                      <div role="listitem" class="collection-item w-dyn-item w-dyn-repeater-item">
                        <img src="${escapeHtml(img)}" loading="lazy" alt="" class="image"/>
                      </div>
                    `).join('')}
                  </div>
                  <div class="w-dyn-hide w-dyn-empty"><div></div></div>
                </div>
              </div>
            </div>
          </section>
        `;
      }

      return `
        <div data-animation="default" data-collapse="medium" data-duration="400" data-easing="ease" data-easing2="ease" role="banner" class="navbar-new w-nav">
          <div class="container-new nav-container">
            <a href="/Portfolio/" class="brand w-nav-brand">
              <div class="logo-text">Bugrov.space</div>
            </a>
            <nav role="navigation" class="nav-menu w-nav-menu">
              <div class="nav-links-wrap">
                <div class="nav-links-box">
                  <a href="/Portfolio/cases" class="nav-link-new w-nav-link">Кейсы</a>
                  <a href="/Portfolio/about" class="nav-link-new w-nav-link">Обо мне</a>
                  <a href="/Portfolio/audit" class="nav-link-new w-nav-link">Аудит</a>
                  <a href="/Portfolio/rekomendacii" class="nav-link-new w-nav-link">Рекомендации</a>
                </div>
                <div class="nav-links-box">
                  <a href="#" class="nav-link-new hidden w-nav-link">Карьера</a>
                  <a href="/Portfolio/contacts" class="nav-link-new w-nav-link">Контакты</a>
                </div>
              </div>
            </nav>
            <div class="menu-button w-nav-button">
              <div class="burger-wrap">
                <div class="burger-line1"></div>
                <div class="burger-line2"></div>
                <div class="burger-line3"></div>
              </div>
            </div>
          </div>
        </div>
        <div class="page-wrap fixed-nav-page-wrap">
          <section class="section-new hero-section">
            <div class="container-new">
              <div class="projects-hh-wrap">
                <h1 class="h1-new project-h1">${escapeHtml(project.title)}</h1>
                <div class="project-hero-buttons">
                  <a href="javascript:history.back(-1)" class="round-button w-inline-block">
                    <div class="_24-button-arrow">
                      <div class="svg w-embed">
                        <svg width="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M9 14L4 9L9 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                          <path d="M20 20V13C20 11.9391 19.5786 10.9217 18.8284 10.1716C18.0783 9.42143 17.0609 9 16 9H4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                      </div>
                    </div>
                  </a>
                  ${project.website_url ? `
                    <a href="${escapeHtml(project.website_url)}" target="_blank" class="round-button site-button w-inline-block">
                      <div>на сайт</div>
                      <div class="_24-button-arrow">
                        <div class="svg w-embed">
                          <svg width="100%" viewBox="0 0 24 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M5 12.5H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 5.5L19 12.5L12 19.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                          </svg>
                        </div>
                      </div>
                    </a>
                  ` : ''}
                </div>
              </div>
              <div class="content-block mt-100">
                ${projectInfoHtml}
              </div>
              <div class="content-block mt-100 is-relative">
                <div class="pi-title absolute-on-dt">О проекте</div>
                <div class="text-45px">${escapeHtml(project.short_description || '')}</div>
              </div>
              ${project.cover_image ? `
                <div class="content-block mt-100">
                  <div class="image-wrap">
                    <div class="image-wrapper">
                      <img src="${escapeHtml(project.cover_image)}" loading="lazy" alt="" sizes="(max-width: 1279px) 96vw, 1160px" class="image-contain"/>
                      <div class="image-owerlay"></div>
                    </div>
                  </div>
                </div>
              ` : ''}
            </div>
          </section>
          
          ${project.description ? `
            <section class="section-new">
              <div class="container-new">
                <div class="section-core">
                  <div class="content-block mt-100 is-relative">
                    <div class="pi-title absolute-on-dt">ОПИСАНИЕ</div>
                    <div class="text-45px">${escapeHtml(project.description).replace(/\n\n/g, '<br/><br/>').replace(/\n/g, ' ')}</div>
                  </div>
                </div>
              </div>
            </section>
          ` : ''}
          
          ${galleryHtml}
          
          <section id="footer" class="section-new footer-section">
            <div class="footer-scroll-text-row">
              <div class="footer-scroll-text-wrap">
                <div class="footer-scroll-text-box">
                  <div class="footer-scroll-text">bugrov space bugrov space </div>
                </div>
                <div class="footer-scroll-text-box">
                  <div class="footer-scroll-text">bugrov space bugrov space</div>
                </div>
              </div>
            </div>
            <div class="container-new">
              <div class="section-core">
                <div class="_4-col-grid footer-grid">
                  <div class="footer-col">
                    <div class="footer-link-row">
                      <a href="https://www.behance.net/denisbugrov" target="_blank" class="footer-sl">Behance</a>
                    </div>
                    <div class="footer-link-row">
                      <a href="https://dprofile.ru/millman" target="_blank" class="footer-sl">Dprofile</a>
                    </div>
                    <div class="footer-link-row">
                      <a href="https://vk.com/bugrovdesign" target="_blank" class="footer-sl">VK</a>
                    </div>
                    <div class="footer-link-row hidden">
                      <a href="https://t.me/BugrovStudio" target="_blank" class="footer-sl">Telegram</a>
                    </div>
                  </div>
                  <div class="footer-col">
                    <div class="footer-link-row">
                      <a href="/Portfolio/cases" class="footer-link">Кейсы</a>
                    </div>
                    <div class="footer-link-row">
                      <a href="/Portfolio/about" class="footer-link">Обо мне</a>
                    </div>
                    <div class="footer-link-row hidden">
                      <a href="#" class="footer-link">Вакансии</a>
                    </div>
                    <div class="footer-link-row">
                      <a href="/Portfolio/audit" class="footer-link">Аудит</a>
                    </div>
                    <div class="footer-link-row">
                      <a href="/Portfolio/rekomendacii" class="footer-link">Рекомендации</a>
                    </div>
                    <div class="footer-link-row">
                      <a href="/Portfolio/contacts" class="footer-link">Контакты</a>
                    </div>
                  </div>
                </div>
              </div>
              <div class="footer-bottom">
                <div>Bugrov.space 2025</div>
                <div class="text-center">ИП Бугров <br/>ИНН 781428200302 <br/>ОГРНИП 318784700283660</div>
                <div>all rights reveserved</div>
              </div>
            </div>
          </section>
        </div>
      `;
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    if (slug) {
      loadProject();
    } else {
      showError('Ошибка URL', 'Не указан slug проекта.');
    }
  </script>
  <script src="/Portfolio/assets/js/jquery-3.5.1.min.dc5e7f18c8.js" type="text/javascript"></script>
  <script src="/Portfolio/assets/62797855494abeff5a9f1db0/js/webflow.d48fc120a.js" type="text/javascript"></script>
</body>
</html>
